/**
 * @author      OA Wu <comdan66@gmail.com>
 * @copyright   Copyright (c) 2014 OA Wu Design
 */
var objs=["#account","#email","#nickname","#birthday","#gender"],error=function(a,e){e.parent(".form-group").addClass("has-error"),$("#alert").empty().text(a).show(),$("#register_div").effect("shake"),e.data("correct",!1),e.nextAll(".input-group-note").removeClass("true").removeClass("loading").addClass("false"),clearTimeout(r);var r=setTimeout(function(){jQuery.map(objs,function(a){$(a).parent(".form-group").removeClass("has-error"),$(a).nextAll(".input-group-note").removeClass("true").removeClass("false").removeClass("loading")}),$("#alert").empty().hide("blind")},3e3)},checkAccountFormat=function(a){return 0==a.val().length||""==a.val().length?error("沒有輸入帳號，請輸入帳號!",a):a.val().match(/^[A-Za-z]+[_0-9]*$/)?!0:error("輸入帳號格式不符合，請重新輸入帳號!",a)},checkNicknameFormat=function(a){return 0==a.val().length||""==a.val().length?error("沒有輸入暱稱，請輸入暱稱!",a):!0},checkBirthdayFormat=function(a){return 0==a.val().length||""==a.val().length?error("沒有選擇生日，請選擇生日!",a):!0},checkEmailFormat=function(a){return 0==a.val().length||""==a.val().length?error("沒有輸入帳號，請輸入帳號!",a):a.val().match(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/)?!0:error("輸入帳號格式不符合，請重新輸入帳號!",a)};$(function(){$("#birthday").datepicker({changeMonth:!0,changeYear:!0,firstDay:0,dateFormat:"yy-mm-dd",yearRange:"1901:2030",maxDate:0}),$("#account").change(function(){var a=$(this);if(checkAccountFormat(a)){var e=a.val(),r=a.nextAll(".input-group-note").removeClass("true").removeClass("false").addClass("loading");$.ajax({url:$("#check_account_double_url").val(),data:{account:e},async:!0,cache:!1,dataType:"json",type:"POST",beforeSend:function(){}}).done(function(e){e.status?(r.removeClass("loading").removeClass("false").addClass("true"),a.data("correct",!0)):error(e.message,a)}).fail(function(a){ajaxError(a)}).complete(function(){})}}),$("#email").change(function(){var a=$(this);if(checkEmailFormat(a)){var e=a.val(),r=a.nextAll(".input-group-note").removeClass("true").removeClass("false").addClass("loading");$.ajax({url:$("#check_email_double_url").val(),data:{email:e},async:!0,cache:!1,dataType:"json",type:"POST",beforeSend:function(){}}).done(function(e){e.status?(r.removeClass("loading").removeClass("false").addClass("true"),a.data("correct",!0)):error(e.message,a)}).fail(function(a){ajaxError(a)}).complete(function(){})}}),$("#nickname").change(function(){var a=$(this),e=a.nextAll(".input-group-note").removeClass("true").removeClass("false").addClass("loading");checkNicknameFormat(a)&&(a.data("correct",!0),e.removeClass("loading").removeClass("false").addClass("true"))}),$("#birthday").change(function(){var a=$(this),e=a.nextAll(".input-group-note").removeClass("true").removeClass("false").addClass("loading");checkBirthdayFormat(a)&&(a.data("correct",!0),e.removeClass("loading").removeClass("false").addClass("true"))}),$("#register").click(function(){var correct=!0;if(console.info($("#oauth_start_url").val()),jQuery.map(objs,function(a){var e=$(a);correct&&(correct=correct&&("true"==e.data("correct")||1==e.data("correct")?!0:!1),correct||error("有欄位資料不正確，請再次檢查!",e))}),correct){var account=$("#account").val(),email=$("#email").val(),nickname=$("#nickname").val(),birthday=$("#birthday").val(),gender=$("#gender").val(),$waitDialog=showWait("處理中...",'請稍候，系統處理中 ...<br/><br/><center><img src="data:image/gif;base64,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" /></center>',!1);$.ajax({url:$("#oauth_start_url").val(),data:{account:account,email:email,nickname:nickname,birthday:birthday,gender:gender},async:!0,cache:!1,dataType:"json",type:"POST",beforeSend:function(){$("#register").bs_button("loading"),$waitDialog.OA_Dialog("open")}}).done(function(result){result.status?showAlert(result.title,result.message,eval("("+result.action+")")):error(result.message,$(objs.join(", ")))}).fail(function(a){ajaxError(a)}).complete(function(){$("#register").bs_button("reset"),$waitDialog.OA_Dialog("close")})}})});